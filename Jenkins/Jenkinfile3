pipeline {
  agent any

  tools {
    // Configure these names in: Manage Jenkins > Tools
    jdk   'JDK11'    // <-- a JDK 11 you define in Jenkins Tools
    maven 'Maven3'   // <-- a Maven you define in Jenkins Tools
  }

  // Make sure JAVA_HOME and PATH point to the JDK11 during the build
  environment {
    JAVA_HOME = "${tool 'JDK11'}"
    MAVEN_HOME = "${tool 'Maven3'}"
    PATH = "${MAVEN_HOME}/bin:${JAVA_HOME}/bin:${PATH}"
  }

  stages {
    stage('Checkout') {
      steps {
        git branch: 'Jenkins', url: 'https://github.com/sharath050175/DevOps.git'
      }
    }

    stage('Show Versions') {
      steps {
        sh 'java -version'
        sh 'mvn -version'
      }
    }

    stage('Build & Test') {
      steps {
        sh 'mvn -B clean verify'   // compile + test
      }
    }

    stage('Package') {
      steps {
        sh 'mvn -B package'
      }
    }
  }

  post {
    always {
      junit 'target/surefire-reports/*.xml'
      archiveArtifacts artifacts: 'target/*.jar', fingerprint: true
    }
  }
}